"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Observable_1 = require("rxjs/internal/Observable");
var Subscription_1 = require("rxjs/internal/Subscription");
var from_1 = require("./from");
function race() {
    var sources = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        sources[_i] = arguments[_i];
    }
    if (sources.length === 1 && Array.isArray(sources[0])) {
        sources = sources[0];
    }
    return new Observable_1.Observable(function (subscriber) {
        var subscription = new Subscription_1.Subscription();
        var subscriptions = [];
        var _loop_1 = function (s) {
            var source = from_1.from(sources[s]);
            var innerSubs = source.subscribe({
                next: function (value) {
                    if (subscriptions) {
                        for (var i = 0; i < subscriptions.length; i++) {
                            if (i !== s) {
                                subscriptions[i].unsubscribe();
                            }
                        }
                        subscriptions = null;
                    }
                    subscriber.next(value);
                },
                error: function (err) { subscriber.error(err); },
                complete: function () { subscriber.complete(); },
            });
            subscriptions.push(innerSubs);
            subscription.add(innerSubs);
        };
        for (var s = 0; s < sources.length && !subscriber.closed; s++) {
            _loop_1(s);
        }
        return subscription;
    });
}
exports.race = race;
//# sourceMappingURL=race.js.map