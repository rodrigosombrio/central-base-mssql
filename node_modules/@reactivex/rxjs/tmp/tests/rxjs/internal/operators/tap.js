"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var userFunction_1 = require("../util/userFunction");
function tap(nextOrObserver) {
    return function (source) { return source.lift(tapOperator(nextOrObserver)); };
}
exports.tap = tap;
function tapOperator(nextOrObserver) {
    return function tapLifted(source) {
        var mut = this;
        var _error = mut.error;
        if (nextOrObserver) {
            if (typeof nextOrObserver === 'object') {
                if (nextOrObserver.next) {
                    mut.next = wrap(_error, nextOrObserver.next, mut.next, nextOrObserver);
                }
                if (nextOrObserver.error) {
                    mut.error = wrap(_error, nextOrObserver.error, _error, nextOrObserver);
                }
                if (nextOrObserver.complete) {
                    mut.complete = wrap(_error, nextOrObserver.complete, mut.complete, nextOrObserver);
                }
            }
            else {
                mut.next = wrap(_error, nextOrObserver, mut.next);
            }
        }
        return source.subscribe(mut);
    };
}
function wrap(forwardError, handler, forwardFn, handlerContext) {
    return function () {
        var result = userFunction_1.tryUserFunction(handler, arguments, handlerContext);
        if (userFunction_1.resultIsError(result)) {
            forwardError(result.error);
        }
        forwardFn.apply(undefined, arguments);
    };
}
//# sourceMappingURL=tap.js.map