"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Subscription_1 = require("rxjs/internal/Subscription");
var asyncScheduler_1 = require("rxjs/internal/scheduler/asyncScheduler");
function QueueSchedulerImpl() {
    this._flushing = false;
    this._queue = [];
}
var proto = QueueSchedulerImpl.prototype;
proto.now = function () {
    return Date.now();
};
proto.schedule = function (work, delay, state, subs) {
    if (delay === void 0) { delay = 0; }
    if (state === void 0) { state = undefined; }
    subs = subs || new Subscription_1.Subscription();
    if (delay > 0) {
        return asyncScheduler_1.asyncScheduler.schedule(work, delay, state, subs);
    }
    var queue = this._queue;
    subs.add(function () {
        var i = queue.indexOf(work);
        queue.splice(i, 2);
    });
    queue.push(work, state);
    if (!this._flushing) {
        this._flushing = true;
        while (queue.length > 0) {
            queue.shift()(queue.shift());
        }
        this._flushing = false;
    }
    return subs;
};
exports.QueueScheduler = QueueSchedulerImpl;
exports.queueScheduler = new exports.QueueScheduler();
//# sourceMappingURL=QueueScheduler.js.map